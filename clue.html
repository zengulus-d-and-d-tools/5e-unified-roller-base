<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ravnica Smart Clue Gen</title>
    <style>
        :root {
            --bg: #121212;
            --card: #1e1e1e;
            --border: #333;
            --text: #e0e0e0;
            --text-dim: #888;
            --accent: #4ecdc4;
            --gold: #f1c40f;
            --danger: #ff6b6b;
            
            /* Status Colors */
            --st-grey: #444;
            --st-orange: #e67e22;
            --st-green: #27ae60;
        }

        body {
            background-color: var(--bg); color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh; box-sizing: border-box;
        }

        h1 { margin: 0 0 5px 0; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--accent); }
        p.sub { margin: 0 0 20px 0; font-size: 0.8rem; color: var(--text-dim); text-align: center; max-width: 500px; }

        /* GUILD GRID */
        .guild-grid {
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;
            width: 100%; max-width: 600px; margin-bottom: 20px;
        }

        .guild-btn {
            background: var(--card); border: 2px solid var(--border);
            border-radius: 8px; padding: 10px 5px;
            cursor: pointer; user-select: none;
            display: flex; flex-direction: column; align-items: center; gap: 4px;
            transition: all 0.2s; position: relative;
        }
        .guild-btn:hover { border-color: #777; }
        
        /* STATES */
        .guild-btn.st-0 { border-color: var(--st-grey); opacity: 0.5; filter: grayscale(100%); } /* Not Involved */
        
        .guild-btn.st-1 { /* Red Herring */
            border-color: var(--st-orange); 
            background: rgba(230, 126, 34, 0.15); 
            opacity: 1; 
        } 
        
        .guild-btn.st-2 { /* Involved */
            border-color: var(--st-green); 
            background: rgba(39, 174, 96, 0.15); 
            opacity: 1; 
            box-shadow: 0 0 10px rgba(39, 174, 96, 0.2); 
        }

        .status-badge {
            position: absolute; top: -5px; right: -5px;
            font-size: 0.6rem; font-weight: bold;
            padding: 2px 5px; border-radius: 4px;
            color: #000; display: none;
        }
        .st-1 .status-badge { display: block; background: var(--st-orange); content: "H"; }
        .st-2 .status-badge { display: block; background: var(--st-green); content: "INV"; }

        .g-icon { font-size: 1.4rem; }
        .g-name { font-size: 0.65rem; font-weight: bold; text-transform: uppercase; }

        /* CONTROLS */
        .controls { display: flex; gap: 10px; margin-bottom: 20px; width: 100%; max-width: 600px; }
        .mode-select {
            flex: 1; background: var(--card); color: white; border: 1px solid var(--border);
            padding: 10px; border-radius: 6px; font-weight: bold; cursor: pointer;
        }
        .gen-btn {
            flex: 2; background: var(--accent); color: #000; border: none;
            padding: 10px; border-radius: 6px; font-weight: 800; text-transform: uppercase;
            cursor: pointer; transition: transform 0.1s;
        }
        .gen-btn:active { transform: scale(0.98); }

        /* RESULT CARD */
        .result-card {
            background: var(--card); width: 100%; max-width: 600px;
            border-radius: 12px; border: 1px solid var(--border);
            overflow: hidden; display: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease-out;
            position: relative;
        }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .res-header {
            padding: 10px 15px; background: rgba(0,0,0,0.3);
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border);
        }
        .res-type { font-size: 0.7rem; font-weight: bold; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.1em; }
        
        .res-body { padding: 20px; }
        
        /* THE ALGORITHM DISPLAY */
        .clue-sentence { font-size: 1.1rem; line-height: 1.6; color: #ccc; }
        .hl-base { color: #fff; font-weight: bold; border-bottom: 1px dashed #555; }
        .hl-core { color: var(--st-green); font-weight: bold; background: rgba(39, 174, 96, 0.1); padding: 0 4px; border-radius: 4px; }
        .hl-surf { color: var(--st-orange); font-weight: bold; background: rgba(230, 126, 34, 0.1); padding: 0 4px; border-radius: 4px; }

        .logic-explainer {
            margin-top: 15px; padding-top: 15px; border-top: 1px solid #333;
            font-size: 0.75rem; color: #666; font-family: monospace;
            display: flex; gap: 10px; justify-content: center;
        }

        .res-footer {
            background: rgba(0,0,0,0.2); padding: 15px;
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
            font-size: 0.85rem;
        }
        .res-stat { display: flex; flex-direction: column; gap: 4px; }
        .res-label { font-size: 0.7rem; font-weight: bold; color: var(--text-dim); text-transform: uppercase; }
        .res-val { font-weight: bold; }

    </style>
</head>
<body>

    <h1>Intersection Generator</h1>
    <p class="sub">
        <strong>Signal vs. Noise:</strong><br>
        <span style="color:var(--st-green)">Green (Involved)</span> generates the <em>Core Object</em>.<br>
        <span style="color:var(--st-orange)">Orange (Herring)</span> generates the <em>Surface Context</em>.
    </p>

    <div class="guild-grid" id="guildGrid"></div>

    <div class="controls">
        <select id="modeSel" class="mode-select">
            <option value="phys">Physical</option>
            <option value="soc">Social</option>
            <option value="arc">Arcane</option>
        </select>
        <button class="gen-btn" onclick="generateClue()">Triangulate Clue</button>
    </div>

    <div class="result-card" id="resultCard">
        <div class="res-header">
            <span class="res-type" id="outType">Physical Evidence</span>
        </div>
        <div class="res-body">
            <div class="clue-sentence" id="outText">
                </div>
            <div class="logic-explainer">
                <span>SIGNAL: <span id="logSignal">DIMIR</span></span>
                <span>//</span>
                <span>NOISE: <span id="logNoise">GOLGARI</span></span>
            </div>
        </div>
        <div class="res-footer">
            <div class="res-stat">
                <span class="res-label">Environmental Friction</span>
                <span class="res-val" style="color:var(--gold)" id="outFric">Water-Damaged</span>
            </div>
            <div class="res-stat">
                <span class="res-label">Fail-Forward Cost</span>
                <span class="res-val" style="color:var(--danger)" id="outCost">Clock +1</span>
            </div>
        </div>
    </div>

<script>
    // --- DATASETS ---
    // Core = The Object/Identity (Involved)
    // Surf = The Coating/Context (Red Herring)

    const GUILDS = [
        { 
            id: 'azorius', name: 'Azorius', icon: 'âš–ï¸', 
            phys: { core: "a rigid legal writ", surf: "stamped with blue wax seals" },
            soc: { core: "a precise, condescending lawmage", surf: "citing obscure statutes" },
            arc: { core: "a geometric stasis-glyph", surf: "humming with Law-magic" }
        },
        { 
            id: 'boros', name: 'Boros', icon: 'âš”ï¸', 
            phys: { core: "a dented military-grade gauntlet", surf: "scorched by radiant heat" },
            soc: { core: "an aggressive legionnaire", surf: "demanding immediate compliance" },
            arc: { core: "a flickering radiant aura", surf: "smelling of forge-smoke" }
        },
        { 
            id: 'dimir', name: 'Dimir', icon: 'ðŸ‘ï¸', 
            phys: { core: "a strip of black cipher-paper", surf: "damp with sewer fog" },
            soc: { core: "a vague, forgettable informant", surf: "hiding in the shadows" },
            arc: { core: "a psychic memory-thread", surf: "chilled by necrotic cold" }
        },
        { 
            id: 'golgari', name: 'Golgari', icon: 'ðŸ„', 
            phys: { core: "a petrified insect husk", surf: "covered in vibrant moss" },
            soc: { core: "a fatalistic rot-farmer", surf: "surrounded by a insect swarm" },
            arc: { core: "a necrotic spore-cloud", surf: "reeking of pungent rot" }
        },
        { 
            id: 'gruul', name: 'Gruul', icon: 'ðŸ”¥', 
            phys: { core: "a smashed stone totem", surf: "smeared with war-paint" },
            soc: { core: "a hostile wasteland scout", surf: "shouting primal threats" },
            arc: { core: "a chaotic elemental spark", surf: "crackling with red and green static" }
        },
        { 
            id: 'izzet', name: 'Izzet', icon: 'âš¡', 
            phys: { core: "a twisted copper coil", surf: "smelling of sharp ozone" },
            soc: { core: "a manic, twitchy researcher", surf: "covered in soot and oil" },
            arc: { core: "an unstable mana-flux", surf: "vibrating with electric current" }
        },
        { 
            id: 'orzhov', name: 'Orzhov', icon: 'ðŸª™', 
            phys: { core: "a gilded debt-contract", surf: "dusted with funeral ash" },
            soc: { core: "a guilt-tripping pontiff", surf: "demanding a tithe" },
            arc: { core: "a spectral spirit-chain", surf: "weighing heavy on the soul" }
        },
        { 
            id: 'rakdos', name: 'Rakdos', icon: 'ðŸŽ­', 
            phys: { core: "a jagged, spiked chain", surf: "splattered with dried blood" },
            soc: { core: "a mocking performance artist", surf: "laughing inappropriately" },
            arc: { core: "a burning hell-rune", surf: "smelling of sulfur" }
        },
        { 
            id: 'selesnya', name: 'Selesnya', icon: 'ðŸŒ³', 
            phys: { core: "a woven living-wood token", surf: "dusted with golden pollen" },
            soc: { core: "a serene evangelist", surf: "speaking in the plural 'We'" },
            arc: { core: "a harmonious light-beam", surf: "connecting to nearby life" }
        },
        { 
            id: 'simic', name: 'Simic', icon: 'ðŸ§¬', 
            phys: { core: "a glass vial of bio-fluid", surf: "coated in translucent slime" },
            soc: { core: "a clinical biomancer", surf: "examining you like a specimen" },
            arc: { core: "a spiral-shaped energy pattern", surf: "shifting and evolving color" }
        }
    ];

    const BASE_CLUES = {
        phys: [
            "You find [CORE], which is [SURF].",
            "Hidden underneath is [CORE], surprisingly [SURF].",
            "Discarded in the corner is [CORE], [SURF].",
            "Lodged in the wall is [CORE], [SURF]."
        ],
        soc: [
            "You interview [CORE], who is [SURF].",
            "A witness describes [CORE], [SURF].",
            "You corner [CORE], [SURF].",
            "An informant points you to [CORE], [SURF]."
        ],
        arc: [
            "You detect [CORE], [SURF].",
            "Your spell reveals [CORE], [SURF].",
            "The air is thick with [CORE], [SURF].",
            "A residue remains of [CORE], [SURF]."
        ]
    };

    const FRICTIONS = [
        "Water-Damaged", "Booby-Trapped", "Locked / Encrypted", "Contaminated", 
        "Heavily Guarded", "Culturally Taboo", "Physically Stuck", "Magically Warded", 
        "Currently Burning", "Moving Target", "Buried in Trash", "Incomplete"
    ];

    const COSTS = [
        "Clock +1", "Heat +1", "Resource Cost", "Reputation -1", "Minor Injury", 
        "Exhaustion", "Info Leak", "Set-Piece Trigger", "Disadvantage", "Spell Slot Drain"
    ];

    // Status: 0 = Grey, 1 = Herring (Orange), 2 = Involved (Green)
    let guildStatus = new Array(10).fill(0);

    // --- INITIALIZATION ---
    function init() {
        const grid = document.getElementById('guildGrid');
        GUILDS.forEach((g, idx) => {
            const btn = document.createElement('div');
            btn.className = 'guild-btn st-0';
            btn.innerHTML = `
                <span class="status-badge"></span>
                <span class="g-icon">${g.icon}</span>
                <span class="g-name">${g.name}</span>
            `;
            btn.onclick = () => toggleStatus(idx, btn);
            grid.appendChild(btn);
        });
    }

    function toggleStatus(idx, btn) {
        guildStatus[idx] = (guildStatus[idx] + 1) % 3;
        btn.className = `guild-btn st-${guildStatus[idx]}`;
        const badge = btn.querySelector('.status-badge');
        if(guildStatus[idx] === 1) badge.innerText = "NOISE";
        if(guildStatus[idx] === 2) badge.innerText = "SIGNAL";
    }

    // --- GENERATOR LOGIC ---
    function generateClue() {
        const mode = document.getElementById('modeSel').value;
        const involvedIndices = guildStatus.map((s, i) => s === 2 ? i : -1).filter(i => i !== -1);
        const herringIndices = guildStatus.map((s, i) => s === 1 ? i : -1).filter(i => i !== -1);

        if (involvedIndices.length === 0) {
            alert("Please select at least one INVOLVED (Green) guild.");
            return;
        }

        // 1. Pick the Signal (Involved Guild)
        const signalIdx = involvedIndices[Math.floor(Math.random() * involvedIndices.length)];
        const signalGuild = GUILDS[signalIdx];

        // 2. Pick the Noise (Herring Guild)
        // If no herrings selected, pick a random non-involved guild as "Ambient Noise"
        let noiseIdx = -1;
        if (herringIndices.length > 0) {
            noiseIdx = herringIndices[Math.floor(Math.random() * herringIndices.length)];
        } else {
            const available = GUILDS.map((_, i) => i).filter(i => i !== signalIdx);
            noiseIdx = available[Math.floor(Math.random() * available.length)];
        }
        const noiseGuild = GUILDS[noiseIdx];

        // 3. Construct the Sentence
        const template = BASE_CLUES[mode][Math.floor(Math.random() * BASE_CLUES[mode].length)];
        const coreText = signalGuild[mode].core;
        const surfText = noiseGuild[mode].surf;

        let finalHtml = template
            .replace("[CORE]", `<span class="hl-core">${coreText}</span>`)
            .replace("[SURF]", `<span class="hl-surf">${surfText}</span>`);

        // 4. Extras
        const friction = FRICTIONS[Math.floor(Math.random() * FRICTIONS.length)];
        const cost = COSTS[Math.floor(Math.random() * COSTS.length)];

        renderResult(mode, finalHtml, friction, cost, signalGuild.name, noiseGuild.name);
    }

    function renderResult(mode, html, friction, cost, sigName, noiseName) {
        const card = document.getElementById('resultCard');
        card.style.display = 'none';
        card.offsetHeight; 
        card.style.display = 'block';

        document.getElementById('outType').innerText = mode.toUpperCase() + " LEAD";
        document.getElementById('outText').innerHTML = html;
        document.getElementById('outFric').innerText = friction;
        document.getElementById('outCost').innerText = cost;
        
        document.getElementById('logSignal').innerText = sigName;
        document.getElementById('logNoise').innerText = noiseName;
    }

    init();

</script>
</body>
</html>
