<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ravnica Intersection Gen</title>
    <style>
        :root {
            --bg: #0f0f13;
            --card-bg: rgba(30, 30, 35, 0.6);
            --border: rgba(255, 255, 255, 0.1);
            --text: #e0e0e0;
            --text-dim: #aaa;
            --accent: #4ecdc4;
            --accent-glow: rgba(78, 205, 196, 0.4);
            --gold: #f1c40f;
            --danger: #ff6b6b;
            --glass: blur(12px);

            --st-grey: #444;
            --st-orange: #e67e22;
            --st-green: #2ecc71;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        body {
            background: linear-gradient(135deg, #0f0f13 0%, #1a1a20 100%);
            color: var(--text);
            font-family: 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 80px 20px 20px;
            /* Space for fixed header */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
            overscroll-behavior-y: none;
            overflow-x: hidden;
        }

        /* --- HEADER --- */
        .header-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(15, 15, 19, 0.95);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            z-index: 1000;
            backdrop-filter: var(--glass);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        }

        h1 {
            margin: 0 0 5px 0;
            font-size: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--accent);
            text-shadow: 0 0 10px var(--accent-glow);
            text-align: center;
        }

        p.sub {
            margin: 0 0 25px 0;
            font-size: 0.9rem;
            color: var(--text-dim);
            text-align: center;
            max-width: 500px;
            line-height: 1.5;
        }

        /* GUILD GRID */
        .guild-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            width: 100%;
            max-width: 600px;
            margin-bottom: 25px;
            position: relative;
            z-index: 2;
        }

        .guild-btn {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 15px 5px;
            cursor: pointer;
            user-select: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            backdrop-filter: blur(5px);
        }

        .guild-btn:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--accent);
        }

        .guild-btn.st-0 {
            border-color: var(--border);
            opacity: 0.6;
            filter: grayscale(100%);
        }

        .guild-btn.st-0:hover {
            opacity: 1;
            filter: grayscale(0%);
        }

        .guild-btn.st-1 {
            border-color: var(--st-orange);
            background: rgba(230, 126, 34, 0.15);
            opacity: 1;
            box-shadow: 0 0 15px rgba(230, 126, 34, 0.2);
            transform: scale(1.02);
        }

        .guild-btn.st-2 {
            border-color: var(--st-green);
            background: rgba(39, 174, 96, 0.15);
            opacity: 1;
            box-shadow: 0 0 15px rgba(39, 174, 96, 0.2);
            transform: scale(1.05);
            z-index: 5;
        }

        .status-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            font-size: 0.6rem;
            font-weight: 800;
            padding: 2px 6px;
            border-radius: 4px;
            color: #000;
            display: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .st-1 .status-badge {
            display: block;
            background: var(--st-orange);
            content: "NOISE";
        }

        .st-2 .status-badge {
            display: block;
            background: var(--st-green);
            content: "SIGNAL";
        }

        .g-icon {
            font-size: 1.8rem;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.5));
        }

        .g-name {
            font-size: 0.7rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* CONTROLS */
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            width: 100%;
            max-width: 600px;
            position: relative;
            z-index: 2;
        }

        .mode-select {
            flex: 1;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            border: 1px solid var(--border);
            padding: 12px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            transition: 0.2s;
        }

        .mode-select:hover,
        .mode-select:focus {
            border-color: var(--accent);
            outline: none;
        }

        .gen-btn {
            flex: 2;
            background: var(--accent);
            color: #0f0f13;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 0 20px var(--accent-glow);
        }

        .gen-btn:hover {
            background: #fff;
            transform: translateY(-2px);
            box-shadow: 0 4px 25px var(--accent-glow);
        }

        .gen-btn:active {
            transform: scale(0.98);
        }

        /* RESULT CARD */
        .result-card {
            background: var(--card-bg);
            width: 100%;
            max-width: 600px;
            border-radius: 16px;
            border: 1px solid var(--border);
            overflow: hidden;
            display: none;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(16px);
            animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            z-index: 2;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .res-header {
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }

        .res-type {
            font-size: 0.8rem;
            font-weight: 900;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        .res-body {
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* DATA BLOCKS */
        .data-block {
            padding: 20px;
            border-radius: 10px;
            position: relative;
            border-left: 5px solid #555;
            background: rgba(255, 255, 255, 0.03);
            transition: transform 0.2s;
        }

        .data-block:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(2px);
        }

        .data-block.signal {
            border-color: var(--st-green);
            background: linear-gradient(90deg, rgba(39, 174, 96, 0.1) 0%, transparent 100%);
        }

        .data-block.noise {
            border-color: var(--st-orange);
            background: linear-gradient(90deg, rgba(230, 126, 34, 0.1) 0%, transparent 100%);
        }

        .lbl {
            font-size: 0.7rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 6px;
            display: block;
            opacity: 0.9;
        }

        .val {
            font-size: 1.25rem;
            font-weight: 500;
            color: #fff;
            line-height: 1.4;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .g-tag {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 0.7rem;
            font-weight: 800;
            text-transform: uppercase;
            padding: 4px 8px;
            border-radius: 6px;
            background: rgba(0, 0, 0, 0.5);
            color: #ccc;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .res-footer {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px 25px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            border-top: 1px solid var(--border);
        }

        .res-stat {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .res-stat label {
            font-size: 0.7rem;
            font-weight: bold;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .res-stat span {
            font-weight: bold;
            font-size: 1rem;
        }

        canvas#vector-cloud {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .protocol-box {
            background: var(--card-bg);
            border: 1px solid var(--border);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            font-size: 0.85rem;
            color: #aaa;
            max-width: 600px;
            text-align: center;
            backdrop-filter: blur(5px);
            position: relative;
            z-index: 2;
        }
    </style>
</head>

<body>
    <canvas id="vector-cloud"></canvas>

    <div class="header-bar">
        <a href="tools.html"
            style="color:#888; text-decoration:none; font-weight:bold; font-size:0.9rem; transition:0.2s;">&larr;
            Portal</a>
        <span
            style="color:var(--text); font-weight:900; text-transform:uppercase; letter-spacing:1px; font-size:1rem;">Intersection
            Gen</span>
    </div>

    <h1>Intersection Gen v4</h1>
    <p class="sub">
        <strong style="color:var(--st-green)">Signal</strong> = The Clue Object &nbsp;|&nbsp;
        <strong style="color:var(--st-orange)">Noise</strong> = The Context / Coating
    </p>

    <div class="protocol-box">
        <span style="color:var(--accent); font-weight:bold;">Usage Protocol:</span> Click Guilds below to toggle
        status.<br>
        1 Click = <span style="color:var(--st-orange); font-weight:bold;">NOISE</span> (Herring) | 2 Clicks = <span
            style="color:var(--st-green); font-weight:bold;">SIGNAL</span> (Involved)<br>
        Generator picks 1 Signal and 1 Noise from selected guilds.
    </div>

    <div class="guild-grid" id="guildGrid"></div>

    <div class="controls">
        <select id="modeSel" class="mode-select">
            <option value="phys">Physical</option>
            <option value="soc">Social</option>
            <option value="arc">Arcane</option>
        </select>
        <button class="gen-btn" onclick="generateClue()">Generate Data</button>
    </div>

    <div class="result-card" id="resultCard">
        <div class="res-header">
            <span class="res-type" id="outType">Physical Evidence</span>
        </div>

        <div class="res-body">
            <div class="data-block signal" id="objectBlock">
                <span class="lbl" id="objectLabel">The Signal (Object)</span>
                <span class="g-tag" id="objectGuild">Guild</span>
                <div class="val" id="objectVal">A rigid legal writ</div>
            </div>

            <div class="data-block noise" id="contextBlock">
                <span class="lbl" id="contextLabel">The Noise (Context)</span>
                <span class="g-tag" id="contextGuild">Guild</span>
                <div class="val" id="contextVal">Covered in vibrant moss</div>
            </div>
        </div>

        <div class="res-footer">
            <div class="res-stat">
                <label>Friction</label>
                <span style="color:var(--gold)" id="outFric">Locked</span>
            </div>
            <div class="res-stat">
                <label>Fail Cost</label>
                <span style="color:var(--danger)" id="outCost">Heat +1</span>
            </div>
        </div>
    </div>

    <script>
        // --- MASSIVE DATASETS (300 Items) ---
        // Note: 'core' is the Object, 'surf' is the Context.

        const GUILDS = [
            {
                id: 'azorius', name: 'Azorius', icon: 'âš–ï¸',
                phys: [
                    { core: "a rigid legal writ", surf: "stamped with blue wax seals" },
                    { core: "a pair of rusted manacles", surf: "etched with a precinct number" },
                    { core: "a discarded statute book", surf: "marked with corrective red ink" },
                    { core: "a marble gavel", surf: "chipped from heavy use" },
                    { core: "a zoning permit", surf: "filed in triplicate" },
                    { core: "a smashed precog-crystal", surf: "housed in geometric steel" },
                    { core: "a patrolling sphinx's feather", surf: "stiff and metallic to the touch" },
                    { core: "an arrest report", surf: "signed by a Justiciar" },
                    { core: "a stone column fragment", surf: "carved with the Guildpact seal" },
                    { core: "a confiscation lock-box", surf: "sealed with magic-dampening lead" }
                ],
                soc: [
                    { core: "a precise lawmage", surf: "citing obscure statutes" },
                    { core: "a bored desk clerk", surf: "demanding Form 12-B" },
                    { core: "a stern arrester", surf: "looking for a reason to detain you" },
                    { core: "a precognitive mage", surf: "claiming they saw this yesterday" },
                    { core: "a vedalken administrator", surf: "obsessed with the timeline" },
                    { core: "a judge's scribe", surf: "taking shorthand notes furiously" },
                    { core: "a gargoyle patroller", surf: "perched silently above" },
                    { core: "an imperious knight", surf: "refusing to speak to civilians" },
                    { core: "a bureaucratic functionary", surf: "worried about their lunch break" },
                    { core: "a retired senator", surf: "complaining about the 'old days'" }
                ],
                arc: [
                    { core: "a geometric stasis-glyph", surf: "humming with Law-magic" },
                    { core: "a zone of silence", surf: "enforced by white runes" },
                    { core: "a truth-compulsion aura", surf: "tasting like cold iron" },
                    { core: "a detainment sphere", surf: "fading into blue mist" },
                    { core: "a scrying sensor", surf: "scanning for illegal magic" },
                    { core: "a Hieromancy echo", surf: "ordering you to halt" },
                    { core: "a ward against lying", surf: "burning when you speak" },
                    { core: "a residual shielding spell", surf: "forming perfect triangles" },
                    { core: "a spectral gavel", surf: "ringing with psychic force" },
                    { core: "a blindfold of justice", surf: "blocking arcane sight" }
                ]
            },
            {
                id: 'boros', name: 'Boros', icon: 'âš”ï¸',
                phys: [
                    { core: "a dented gauntlet", surf: "scorched by radiant heat" },
                    { core: "a shattered sun-blade", surf: "still warm to the touch" },
                    { core: "a tattered red banner", surf: "stained with soot and blood" },
                    { core: "a military medal", surf: "torn from a uniform" },
                    { core: "a heavy boot print", surf: "cracking the pavement" },
                    { core: "a discarded whetstone", surf: "worn down to a nub" },
                    { core: "a minotaur's horn-ring", surf: "etched with a legion number" },
                    { core: "a fragment of slag", surf: "smelling of the forge" },
                    { core: "a garrison key", surf: "heavy and iron-cast" },
                    { core: "a broken signal-horn", surf: "crushed by a heavy blow" }
                ],
                soc: [
                    { core: "an aggressive legionnaire", surf: "demanding immediate compliance" },
                    { core: "a goblin trench-fighter", surf: "itching for a brawl" },
                    { core: "a righteous paladin", surf: "preaching zeal and fire" },
                    { core: "a weary sergeant", surf: "cleaning their blade" },
                    { core: "a minotaur trooper", surf: "blocking the doorway" },
                    { core: "a sky-knight's squire", surf: "polishing armor" },
                    { core: "a flame-kin scout", surf: "burning with impatience" },
                    { core: "a retired veteran", surf: "showing off their scars" },
                    { core: "a combat medic", surf: "tending to a wound" },
                    { core: "a angel-touched captain", surf: "radiating terrifying authority" }
                ],
                arc: [
                    { core: "a flickering radiant aura", surf: "smelling of forge-smoke" },
                    { core: "a holy fire residue", surf: "singing nearby fabrics" },
                    { core: "a lingering war-shout", surf: "echoing psychically" },
                    { core: "a circle of protection", surf: "glowing with red light" },
                    { core: "a beam of sunlight", surf: "persisting in the dark" },
                    { core: "a healing magic trace", surf: "tingling with warmth" },
                    { core: "a zealot's mark", surf: "burned into the stone" },
                    { core: "a lightning-helix scar", surf: "crackling weakly" },
                    { core: "a spectral shield", surf: "pushing back intruders" },
                    { core: "a summoning rune", surf: "calling for backup" }
                ]
            },
            {
                id: 'dimir', name: 'Dimir', icon: 'ðŸ‘ï¸',
                phys: [
                    { core: "a strip of cipher-paper", surf: "dissolving into smoke" },
                    { core: "a black glass dagger", surf: "coated in sleeping poison" },
                    { core: "a dark velvet cloak", surf: "damp with sewer fog" },
                    { core: "a memory-vial", surf: "swirling with blue mist" },
                    { core: "a skeleton key", surf: "made of shadowy metal" },
                    { core: "a throwing star", surf: "embedded in the ceiling" },
                    { core: "a hidden drop-box", surf: "concealed behind a brick" },
                    { core: "a forged identity paper", surf: "perfectly replicated" },
                    { core: "a destroyed journal", surf: "shredded into confetti" },
                    { core: "a surveillance beetle", surf: "crushed underfoot" }
                ],
                soc: [
                    { core: "a vague informant", surf: "hiding in the shadows" },
                    { core: "a shapeshifter", surf: "forgetting their current face" },
                    { core: "a librarian", surf: "hoarding secrets" },
                    { core: "a street urchin", surf: "watching with too-old eyes" },
                    { core: "a mind-mage", surf: "reading your surface thoughts" },
                    { core: "a nervous courier", surf: "carrying a blank letter" },
                    { core: "a double agent", surf: "playing both sides" },
                    { core: "a ghost agent", surf: "whispering from a vent" },
                    { core: "a night-market broker", surf: "trading in rumors" },
                    { core: "a sleeper agent", surf: "waking up confused" }
                ],
                arc: [
                    { core: "a psychic memory-thread", surf: "chilled by necrotic cold" },
                    { core: "a shadow-weave", surf: "darkening the corners" },
                    { core: "a thought-surveillance eye", surf: "blinking out of existence" },
                    { core: "a memory-hole", surf: "where details are missing" },
                    { core: "a whisper-network echo", surf: "repeating a name" },
                    { core: "a sleep-spell residue", surf: "making you yawn" },
                    { core: "an illusionary wall", surf: "flickering when touched" },
                    { core: "a telepathic stain", surf: "causing a headache" },
                    { core: "a necromantic chill", surf: "frosting the glass" },
                    { core: "a nightmare trace", surf: "triggering fear" }
                ]
            },
            {
                id: 'golgari', name: 'Golgari', icon: 'ðŸ„',
                phys: [
                    { core: "a petrified insect husk", surf: "covered in vibrant moss" },
                    { core: "a compost-encrusted boot", surf: "smelling of the undercity" },
                    { core: "a jar of rot-salve", surf: "bubbling with fermentation" },
                    { core: "a stone elf ear", surf: "chipped from a statue" },
                    { core: "a gorgon's scale", surf: "turning dust to stone" },
                    { core: "a fungal spore-pod", surf: "ready to burst" },
                    { core: "a reclaimed bone tool", surf: "scrimshawed with runes" },
                    { core: "a patch of sewer-slime", surf: "glowing faintly green" },
                    { core: "a beetle-shell shield", surf: "cracked down the middle" },
                    { core: "a recycler's hook", surf: "rusted and dull" }
                ],
                soc: [
                    { core: "a fatalistic rot-farmer", surf: "surrounded by insects" },
                    { core: "a dark elf shaman", surf: "speaking for the dead" },
                    { core: "a kraul warrior", surf: "clicking its mandibles" },
                    { core: "a sewer-guide", surf: "covered in muck" },
                    { core: "a gorgon recluse", surf: "hiding her gaze" },
                    { core: "a spore-druid", surf: "growing mushrooms on their clothes" },
                    { core: "a corpse-collector", surf: "hauling a heavy cart" },
                    { core: "an undercity hermit", surf: "eating something questionable" },
                    { core: "a troll bouncer", surf: "regenerating a wound" },
                    { core: "a fungus-symbiote", surf: "merging with the wall" }
                ],
                arc: [
                    { core: "a necrotic spore-cloud", surf: "reeking of pungent rot" },
                    { core: "a regrowth aura", surf: "sprouting weeds from stone" },
                    { core: "a death-magic stain", surf: "withered nearby plants" },
                    { core: "a petrification echo", surf: "stiffening your joints" },
                    { core: "a poison-mist residue", surf: "burning your lungs" },
                    { core: "a reanimation trace", surf: "making shadows twitch" },
                    { core: "a swarm-mind connection", surf: "buzzing in your ears" },
                    { core: "a decomposition field", surf: "accelerating rust" },
                    { core: "a life-drain signature", surf: "feeling cold and damp" },
                    { core: "a fungal bloom", surf: "pulsing with heartbeat" }
                ]
            },
            {
                id: 'gruul', name: 'Gruul', icon: 'ðŸ”¥',
                phys: [
                    { core: "a smashed stone totem", surf: "smeared with war-paint" },
                    { core: "a crude stone axe", surf: "bound with leather" },
                    { core: "a boar-tusk necklace", surf: "strung on gut" },
                    { core: "a patch of graffiti", surf: "marking clan territory" },
                    { core: "a pile of rubble", surf: "recently demolished" },
                    { core: "a beast-hide tent scrap", surf: "smelling of wet fur" },
                    { core: "a giant's footprint", surf: "crushing a crate" },
                    { core: "a broken siege-arrow", surf: "thick as a limb" },
                    { core: "a ritual bonfire pit", surf: "still smoldering" },
                    { core: "a looting sack", surf: "spilled open" }
                ],
                soc: [
                    { core: "a hostile wasteland scout", surf: "shouting primal threats" },
                    { core: "a two-headed ogre", surf: "arguing with itself" },
                    { core: "a beast-breaker", surf: "calming a hydra" },
                    { core: "a raid-leader", surf: "demanding tribute" },
                    { core: "a shaman", surf: "predicting the End-Raze" },
                    { core: "a rubble-child", surf: "throwing rocks" },
                    { core: "a centaur charger", surf: "pawing the ground" },
                    { core: "a goblin raider", surf: "stealing shiny bits" },
                    { core: "a wild-druid", surf: "hating the pavement" },
                    { core: "a cyclops brute", surf: "blocking the street" }
                ],
                arc: [
                    { core: "a chaotic elemental spark", surf: "crackling with red/green static" },
                    { core: "an earth-tremor echo", surf: "shaking the dust" },
                    { core: "a rage-magic aura", surf: "making blood boil" },
                    { core: "a primal growth surge", surf: "shattering concrete" },
                    { core: "a fire-storm residue", surf: "blackening the walls" },
                    { core: "a beast-bond link", surf: "smelling of musk" },
                    { core: "a destruction rune", surf: "glowing angrily" },
                    { core: "a storm-caller's mark", surf: "wet with rain" },
                    { core: "a wild-magic surge", surf: "tasting like copper" },
                    { core: "a spirit-totem ward", surf: "howling faintly" }
                ]
            },
            {
                id: 'izzet', name: 'Izzet', icon: 'âš¡',
                phys: [
                    { core: "a twisted copper coil", surf: "smelling of sharp ozone" },
                    { core: "a shattered glass capacitor", surf: "leaking blue fluid" },
                    { core: "a mana-pressure gauge", surf: "stuck in the red" },
                    { core: "a goblin's welding goggles", surf: "cracked and sooty" },
                    { core: "a blueprint schematic", surf: "covered in coffee stains" },
                    { core: "a weird-containment unit", surf: "hissing steam" },
                    { core: "a lightning-rod tip", surf: "melted by a strike" },
                    { core: "a mizzium strut", surf: "bent by force" },
                    { core: "a laboratory notebook", surf: "filled with frantic math" },
                    { core: "a gravity-inverter", surf: "floating inches off the ground" }
                ],
                soc: [
                    { core: "a manic researcher", surf: "covered in soot and oil" },
                    { core: "a goblin test-pilot", surf: "missing eyebrows" },
                    { core: "a chemister", surf: "mixing volatile vials" },
                    { core: "a blast-seeker", surf: "twitching with energy" },
                    { core: "a ley-line surveyor", surf: "ignoring safety protocols" },
                    { core: "an elementalist", surf: "followed by a spark" },
                    { core: "a laboratory assistant", surf: "putting out a fire" },
                    { core: "a vedalken engineer", surf: "judging your equipment" },
                    { core: "a steam-vent worker", surf: "shouting over the noise" },
                    { core: "a guild-mage", surf: "overloading a spell" }
                ],
                arc: [
                    { core: "an unstable mana-flux", surf: "vibrating with electric current" },
                    { core: "a gravity-well", surf: "pulling debris inward" },
                    { core: "a teleportation error", surf: "smelling of sulfur" },
                    { core: "a storm-charge", surf: "making hair stand up" },
                    { core: "a heat-haze", surf: "shimmering in the air" },
                    { core: "a time-dilation bubble", surf: "slowing dust motes" },
                    { core: "an elemental residue", surf: "puddling on the floor" },
                    { core: "a sonic boom echo", surf: "ringing in your ears" },
                    { core: "a spell-copy trace", surf: "repeating itself" },
                    { core: "a mizzium-burn", surf: "glowing purple" }
                ]
            },
            {
                id: 'orzhov', name: 'Orzhov', icon: 'ðŸª™',
                phys: [
                    { core: "a gilded debt-contract", surf: "dusted with funeral ash" },
                    { core: "a gold coin", surf: "stamped with a ghost's face" },
                    { core: "a black wax candle", surf: "burning with a white flame" },
                    { core: "a gargoyle fragment", surf: "leaking black oil" },
                    { core: "a tithe-collection box", surf: "heavier than it looks" },
                    { core: "a stained-glass shard", surf: "depicting a saint" },
                    { core: "a spirit-mask", surf: "cold as the grave" },
                    { core: "a velvet alms-pouch", surf: "stained with wine" },
                    { core: "a thrull's collar", surf: "etched with runes" },
                    { core: "a ledger of sins", surf: "bound in pale leather" }
                ],
                soc: [
                    { core: "a guilt-tripping pontiff", surf: "demanding a tithe" },
                    { core: "a blind advokist", surf: "reading a contract" },
                    { core: "a spirit-debtor", surf: "moaning in chains" },
                    { core: "a knight-enforcer", surf: "clanking with gold armor" },
                    { core: "a thrull servant", surf: "obeying silently" },
                    { core: "a coin-mage", surf: "weighing your soul" },
                    { core: "a basilica guard", surf: "blocking the archway" },
                    { core: "a death-priest", surf: "blessing a corpse" },
                    { core: "a syndicate banker", surf: "calculating interest" },
                    { core: "a ghost-council envoy", surf: "floating through a wall" }
                ],
                arc: [
                    { core: "a spectral spirit-chain", surf: "weighing heavy on the soul" },
                    { core: "a life-drain aura", surf: "feeling cold and gray" },
                    { core: "a gold-sickness curse", surf: "tasting of metal" },
                    { core: "a command-word echo", surf: "forcing you to kneel" },
                    { core: "a necrotic residue", surf: "wilting flowers" },
                    { core: "a spirit-guard ward", surf: "watching with dead eyes" },
                    { core: "a silence-spell", surf: "muting all sound" },
                    { core: "a radiance-burn", surf: "searing with holy light" },
                    { core: "a blood-pact sign", surf: "glowing crimson" },
                    { core: "a haunting melody", surf: "drifting from nowhere" }
                ]
            },
            {
                id: 'rakdos', name: 'Rakdos', icon: 'ðŸŽ­',
                phys: [
                    { core: "a jagged spiked chain", surf: "splattered with dried blood" },
                    { core: "a harlequin mask", surf: "grinning maniacally" },
                    { core: "a broken torch", surf: "smelling of lamp oil" },
                    { core: "a rusty cage segment", surf: "bent bars" },
                    { core: "a performer's silk sash", surf: "torn and muddy" },
                    { core: "a fire-juggler's pin", surf: "blackened by soot" },
                    { core: "a demon-bone charm", surf: "warm to the touch" },
                    { core: "a stage-prop dagger", surf: "sharpened to a real edge" },
                    { core: "a festival flyer", surf: "advertising a 'Killer Show'" },
                    { core: "a tightrope wire", surf: "coiled like a snake" }
                ],
                soc: [
                    { core: "a mocking performance artist", surf: "laughing inappropriately" },
                    { core: "a knife-juggler", surf: "playing with a blade" },
                    { core: "a demon-cultist", surf: "chanting a rhyme" },
                    { core: "a chain-devil", surf: "rattling their bindings" },
                    { core: "a ringmaster", surf: "inviting you inside" },
                    { core: "a pain-artist", surf: "covered in piercings" },
                    { core: "a goblin pyromancer", surf: "lighting a fuse" },
                    { core: "a blood-witch", surf: "stirring a cauldron" },
                    { core: "a muscle-bound ogre", surf: "wearing a tiny hat" },
                    { core: "a riot-instigator", surf: "shouting at the crowd" }
                ],
                arc: [
                    { core: "a burning hell-rune", surf: "smelling of sulfur" },
                    { core: "a pain-spike aura", surf: "causing a migraine" },
                    { core: "a madness-echo", surf: "making you giggle" },
                    { core: "a shadow-dance trace", surf: "moving on its own" },
                    { core: "a fire-breath residue", surf: "scorching the ceiling" },
                    { core: "a demon-summoning circle", surf: "drawn in blood" },
                    { core: "a fear-spike", surf: "making your heart race" },
                    { core: "a confusion-mist", surf: "smelling of cheap perfume" },
                    { core: "a chaos-spark", surf: "popping like fireworks" },
                    { core: "a blood-lust enchantment", surf: "making fists clench" }
                ]
            },
            {
                id: 'selesnya', name: 'Selesnya', icon: 'ðŸŒ³',
                phys: [
                    { core: "a woven living-wood token", surf: "dusted with golden pollen" },
                    { core: "a crystal seed", surf: "glowing with inner light" },
                    { core: "a white granite stone", surf: "perfectly polished" },
                    { core: "a wolf-rider's saddle", surf: "smelling of leather" },
                    { core: "a dryad's flower-crown", surf: "still blooming" },
                    { core: "a conclave pamphlet", surf: "preaching unity" },
                    { core: "a healer's kit", surf: "filled with salves" },
                    { core: "an arrow with a leaf-fletching", surf: "tipped with silver" },
                    { core: "a root-woven barrier", surf: "withered and brown" },
                    { core: "a sun-amulet", surf: "reflecting the light" }
                ],
                soc: [
                    { core: "a serene evangelist", surf: "speaking in the plural 'We'" },
                    { core: "a dryad guardian", surf: "merging with a tree" },
                    { core: "a wolf-riding knight", surf: "watching the perimeter" },
                    { core: "a loxodon hierarch", surf: "offering wisdom" },
                    { core: "a centaur archer", surf: "stringing a bow" },
                    { core: "a conclave recruiter", surf: "smiling too widely" },
                    { core: "a vernacular healer", surf: "offering a potion" },
                    { core: "a garden-tender", surf: "ignoring the city" },
                    { core: "a song-weaver", surf: "humming a tune" },
                    { core: "a trostani-priest", surf: "judging your aura" }
                ],
                arc: [
                    { core: "a harmonious light-beam", surf: "connecting to nearby life" },
                    { core: "a growth-surge aura", surf: "making weeds bloom" },
                    { core: "a calming wave", surf: "soothing your anger" },
                    { core: "a summon-pact trace", surf: "smelling of loam" },
                    { core: "a shared-mind echo", surf: "hearing many voices" },
                    { core: "a barrier-ward", surf: "glowing soft white" },
                    { core: "a healing pulse", surf: "closing small cuts" },
                    { core: "a root-strangle residue", surf: "cracking the floor" },
                    { core: "a sun-burst scorch", surf: "bleaching the color" },
                    { core: "a truth-sense field", surf: "vibrating with clarity" }
                ]
            },
            {
                id: 'simic', name: 'Simic', icon: 'ðŸ§¬',
                phys: [
                    { core: "a glass vial of bio-fluid", surf: "coated in translucent slime" },
                    { core: "a shed reptile skin", surf: "shimmering with colors" },
                    { core: "a crab-claw implant", surf: "discarded and bloody" },
                    { core: "a growth-chamber valve", surf: "dripping green goo" },
                    { core: "a notebook of mutations", surf: "waterproof and waxy" },
                    { core: "a coral-encrusted key", surf: "smelling of brine" },
                    { core: "a syringe gun", surf: "loaded with blue serum" },
                    { core: "a preserved specimen", surf: "floating in a jar" },
                    { core: "a krasis scale", surf: "harder than steel" },
                    { core: "a bio-hazard warning sign", surf: "etched in glass" }
                ],
                soc: [
                    { core: "a clinical biomancer", surf: "examining you like a specimen" },
                    { core: "a shark-hybrid warrior", surf: "flexing new gills" },
                    { core: "a merfolk terraformer", surf: "adjusting water levels" },
                    { core: "a zonot guide", surf: "covered in algae" },
                    { core: "a rapid-evolutionist", surf: "twitching with mutations" },
                    { core: "a medical researcher", surf: "holding a scalpel" },
                    { core: "a frog-lizard chimera", surf: "croaking inquisitively" },
                    { core: "a bio-engineer", surf: "taking notes on your biology" },
                    { core: "a deep-sea scout", surf: "dripping saltwater" },
                    { core: "a growth-vat attendant", surf: "smelling of chemicals" }
                ],
                arc: [
                    { core: "a spiral energy pattern", surf: "shifting and evolving color" },
                    { core: "a mutation-aura", surf: "making your skin itch" },
                    { core: "a growth-accel trace", surf: "expanding moss rapidly" },
                    { core: "a bio-luminescent glow", surf: "pulsing in the dark" },
                    { core: "a water-pressure field", surf: "feeling heavy and wet" },
                    { core: "a gene-splice echo", surf: "feeling alien" },
                    { core: "a slime-coat residue", surf: "making the floor slick" },
                    { core: "a cryogenic chill", surf: "fogging your breath" },
                    { core: "a venom-magic signature", surf: "burning your eyes" },
                    { core: "an adaptation-ward", surf: "changing to match attacks" }
                ]
            }
        ];

        const FRICTIONS = [
            "Water-Damaged", "Booby-Trapped", "Locked / Encrypted", "Contaminated",
            "Heavily Guarded", "Culturally Taboo", "Physically Stuck", "Magically Warded",
            "Currently Burning", "Moving Target", "Buried in Trash", "Incomplete"
        ];

        const COSTS = [
            "Clock +1", "Heat +1", "Resource Cost", "Reputation -1", "Minor Injury",
            "Exhaustion", "Info Leak", "Set-Piece Trigger", "Disadvantage", "Spell Slot Drain"
        ];

        // Status: 0 = Grey, 1 = Herring (Orange), 2 = Involved (Green)
        let guildStatus = new Array(10).fill(0);

        // --- INITIALIZATION ---
        function init() {
            const grid = document.getElementById('guildGrid');
            GUILDS.forEach((g, idx) => {
                const btn = document.createElement('div');
                btn.className = 'guild-btn st-0';
                btn.innerHTML = `
                <span class="status-badge"></span>
                <span class="g-icon">${g.icon}</span>
                <span class="g-name">${g.name}</span>
            `;
                btn.onclick = () => toggleStatus(idx, btn);
                grid.appendChild(btn);
            });
        }

        function toggleStatus(idx, btn) {
            guildStatus[idx] = (guildStatus[idx] + 1) % 3;
            btn.className = `guild-btn st-${guildStatus[idx]}`;
            const badge = btn.querySelector('.status-badge');
            if (guildStatus[idx] === 1) badge.innerText = "NOISE";
            if (guildStatus[idx] === 2) badge.innerText = "SIGNAL";
            if (guildStatus[idx] === 0) badge.innerText = "";
        }

        const randIndex = (len) => {
            if (len <= 0) return 0;
            if (window.crypto && window.crypto.getRandomValues) {
                const buf = new Uint32Array(1);
                window.crypto.getRandomValues(buf);
                return buf[0] % len;
            }
            return Math.floor(Math.random() * len);
        };

        const pickEntry = (guild, mode) => {
            const list = guild[mode] || [];
            return list[randIndex(list.length)] || { core: '', surf: '' };
        };

        // --- GENERATOR LOGIC ---
        function generateClue() {
            const mode = document.getElementById('modeSel').value;
            const involvedIndices = guildStatus.map((s, i) => s === 2 ? i : -1).filter(i => i !== -1);
            const herringIndices = guildStatus.map((s, i) => s === 1 ? i : -1).filter(i => i !== -1);

            if (involvedIndices.length === 0) {
                alert("Please select at least one INVOLVED (Green) guild.");
                return;
            }

            const signalIdx = involvedIndices[Math.floor(Math.random() * involvedIndices.length)];
            const signalGuild = GUILDS[signalIdx];

            let noiseIdx = -1;
            if (herringIndices.length > 0) {
                noiseIdx = herringIndices[Math.floor(Math.random() * herringIndices.length)];
            } else {
                const available = GUILDS.map((_, i) => i).filter(i => i !== signalIdx);
                noiseIdx = available[Math.floor(Math.random() * available.length)];
            }
            const noiseGuild = GUILDS[noiseIdx];

            const signalEntry = pickEntry(signalGuild, mode);
            const noiseEntry = pickEntry(noiseGuild, mode);
            const objectIsSignal = Math.random() < 0.5;

            const objectData = objectIsSignal
                ? { text: signalEntry.core, guild: signalGuild.name, role: 'signal' }
                : { text: noiseEntry.core, guild: noiseGuild.name, role: 'noise' };

            const contextData = objectIsSignal
                ? { text: noiseEntry.surf, guild: noiseGuild.name, role: 'noise' }
                : { text: signalEntry.surf, guild: signalGuild.name, role: 'signal' };

            const friction = FRICTIONS[Math.floor(Math.random() * FRICTIONS.length)];
            const cost = COSTS[Math.floor(Math.random() * COSTS.length)];

            renderResult(mode, objectData, contextData, friction, cost);
        }

        function renderResult(mode, objectData, contextData, friction, cost) {
            const card = document.getElementById('resultCard');
            card.style.display = 'none';
            card.offsetHeight;
            card.style.display = 'block';

            document.getElementById('outType').innerText = mode.toUpperCase() + " EVIDENCE";

            const objectBlock = document.getElementById('objectBlock');
            const objectIsSignal = objectData.role === 'signal';
            objectBlock.classList.toggle('signal', objectIsSignal);
            objectBlock.classList.toggle('noise', !objectIsSignal);
            const objectLabel = document.getElementById('objectLabel');
            objectLabel.innerText = `${objectIsSignal ? 'The Signal' : 'The Noise'} (Object)`;
            objectLabel.style.color = objectIsSignal ? 'var(--st-green)' : 'var(--st-orange)';
            document.getElementById('objectGuild').innerText = objectData.guild;
            document.getElementById('objectVal').innerText = objectData.text.charAt(0).toUpperCase() + objectData.text.slice(1);

            const contextIsSignal = contextData.role === 'signal';
            const contextBlock = document.getElementById('contextBlock');
            contextBlock.classList.toggle('signal', contextIsSignal);
            contextBlock.classList.toggle('noise', !contextIsSignal);
            const contextLabel = document.getElementById('contextLabel');
            contextLabel.innerText = `${contextIsSignal ? 'The Signal' : 'The Noise'} (Context)`;
            contextLabel.style.color = contextIsSignal ? 'var(--st-green)' : 'var(--st-orange)';
            document.getElementById('contextGuild').innerText = contextData.guild;
            document.getElementById('contextVal').innerText = contextData.text.charAt(0).toUpperCase() + contextData.text.slice(1);

            document.getElementById('outFric').innerText = friction;
            document.getElementById('outCost').innerText = cost;
        }

        init();

        // --- ADVANCED VECTOR FIELD SCRIPT ---
        (function () {
            const canvas = document.getElementById('vector-cloud');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            let width, height;

            const mouse = { x: -999, y: -999, active: false, down: false };
            let lastScrollY = window.scrollY;
            let scrollVelocity = 0;

            // Grid config
            const SPACING = 30;
            const FIELD_RADIUS = 200;

            // Dynamic Color
            let accentColor = '#4ecdc4';

            const updateAccent = () => {
                const style = getComputedStyle(document.documentElement);
                accentColor = style.getPropertyValue('--accent').trim();
            };

            const resize = () => {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
                updateAccent();
            };

            window.addEventListener('resize', resize);
            window.addEventListener('mousemove', e => {
                mouse.x = e.clientX;
                mouse.y = e.clientY;
                mouse.active = true;
            });
            window.addEventListener('mousedown', () => mouse.down = true);
            window.addEventListener('mouseup', () => mouse.down = false);

            window.addEventListener('touchstart', e => {
                mouse.x = e.touches[0].clientX;
                mouse.y = e.touches[0].clientY;
                mouse.active = true;
                mouse.down = true;
            });
            window.addEventListener('touchmove', e => {
                mouse.x = e.touches[0].clientX;
                mouse.y = e.touches[0].clientY;
            });
            window.addEventListener('touchend', () => { mouse.active = false; mouse.down = false; });

            // Scroll tracking
            window.addEventListener('scroll', () => {
                const currentY = window.scrollY;
                const delta = currentY - lastScrollY;
                scrollVelocity = delta; // Simple velocity
                lastScrollY = currentY;
            });

            resize();

            const animate = () => {
                ctx.clearRect(0, 0, width, height);
                // Decay scroll velocity
                scrollVelocity *= 0.9;

                updateAccent();

                if (!mouse.active && Math.abs(scrollVelocity) < 0.1) {
                    requestAnimationFrame(animate);
                    return;
                }

                const startX = Math.floor((mouse.x - FIELD_RADIUS) / SPACING) * SPACING;
                const endX = Math.floor((mouse.x + FIELD_RADIUS) / SPACING) * SPACING;
                const startY = Math.floor((mouse.y - FIELD_RADIUS) / SPACING) * SPACING;
                const endY = Math.floor((mouse.y + FIELD_RADIUS) / SPACING) * SPACING;

                const time = Date.now();

                for (let gx = startX; gx <= endX; gx += SPACING) {
                    for (let gy = startY; gy <= endY; gy += SPACING) {
                        const dx = gx - mouse.x;
                        const dy = gy - mouse.y;
                        const distSq = dx * dx + dy * dy;

                        if (distSq > FIELD_RADIUS * FIELD_RADIUS) continue;

                        const dist = Math.sqrt(distSq);

                        // Smooth Fade Logic
                        let alpha = 0;
                        if (dist < 40) {
                            alpha = (dist / 40);
                        } else {
                            alpha = 1 - ((dist - 40) / (FIELD_RADIUS - 40));
                        }
                        alpha = Math.max(0, Math.min(1, alpha));

                        if (alpha <= 0.01) continue;

                        // Vector Calculation
                        let angle = Math.atan2(dy, dx);

                        // Click Wiggle
                        if (mouse.down) {
                            angle += Math.sin(time * 0.05 + gx + gy) * 0.5;
                        }

                        // Scroll Buffet
                        const windForce = -scrollVelocity * 0.05;
                        if (Math.abs(windForce) > 0.01) {
                            const vx = Math.cos(angle);
                            const vy = Math.sin(angle);
                            const nvx = vx;
                            const nvy = vy + windForce;
                            angle = Math.atan2(nvy, nvx);
                        }

                        const length = 14 * alpha;

                        // Render
                        const tipX = gx + Math.cos(angle) * length;
                        const tipY = gy + Math.sin(angle) * length;

                        const thickness = length * 0.2;
                        const perpX = -Math.sin(angle) * thickness;
                        const perpY = Math.cos(angle) * thickness;

                        ctx.fillStyle = accentColor;
                        ctx.globalAlpha = alpha * 0.8;

                        ctx.beginPath();
                        ctx.moveTo(gx + perpX, gy + perpY);
                        ctx.lineTo(gx - perpX, gy - perpY);
                        ctx.lineTo(tipX, tipY);
                        ctx.fill();
                    }
                }

                requestAnimationFrame(animate);
            };

            animate();
        })();
    </script>
</body>

</html>
