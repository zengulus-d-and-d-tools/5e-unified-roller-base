<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">
    <title>HQ Designer</title>
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/hq.css">
</head>

<body>
    <canvas id="vector-cloud"></canvas>

    <div class="hq-app">
        <header class="hq-header hero-header">
            <div>
                <p class="eyebrow hero-eyebrow">Campaign Tools</p>
                <h1>HQ Layout Foundry</h1>
                <p class="subtitle hero-subtitle">Blueprint your command post with practical rooms, staging lanes, and
                    support pods tuned for fast operations.</p>
            </div>
            <div class="header-actions hero-actions">
                <div class="action-bar hero-action-bar primary">
                    <a class="btn hero-btn ghost" href="tools.html">Portal</a>
                    <button id="btn-add-custom" class="btn hero-btn ghost">Custom Room</button>
                    <button id="btn-clear" class="btn hero-btn ghost">Clear Floor</button>
                    <button id="btn-export" class="btn hero-btn ghost">Export Data</button>
                    <button id="btn-import" class="btn hero-btn ghost">Import Data</button>
                    <button id="btn-screenshot" class="btn hero-btn accent">Take Screenshot</button>
                </div>
                <div class="action-bar hero-action-bar secondary">
                    <button class="btn hero-btn ghost" data-onclick="triggerAccentPicker()">ðŸŽ¨ Accent</button>
                    <button class="btn hero-btn ghost" id="btn-bg-style" data-onclick="cycleBgStyle()">ðŸŒŒ BG: Field</button>
                </div>
                <input type="color" id="accent-picker-input" class="hq-accent-picker-input"
                    data-onchange="setAccentColor(this.value)">
            </div>
        </header>

        <main class="hq-layout">
            <section class="blueprint-shell">
                <div class="blueprint-toolbar">
                    <div class="stat">
                        <span class="label">Rooms</span>
                        <strong id="stat-room-count">0</strong>
                    </div>
                    <div class="stat">
                        <span class="label">Downtime Slots</span>
                        <strong id="stat-downtime">0</strong>
                    </div>
                    <div class="stat">
                        <span class="label">Resource Bays</span>
                        <strong id="stat-resource">0</strong>
                    </div>
                    <label class="toggle">
                        <input type="checkbox" id="toggle-grid" checked>
                        <span>Snap to Grid</span>
                    </label>
                </div>
                <div class="floor-switcher">
                    <div class="floor-tabs" id="floor-tabs"></div>
                    <div class="floor-buttons">
                        <button id="btn-add-floor" class="btn ghost small">Add Floor</button>
                        <button id="btn-rename-floor" class="btn ghost small">Rename</button>
                        <button id="btn-delete-floor" class="btn ghost small danger-text">Delete</button>
                        <div class="junior-ops-control">
                            <span class="label">Junior Ops:</span>
                            <span id="junior-ops-display" class="count-display">0</span>
                            <span class="sep">/</span>
                            <input type="number" id="junior-ops-max" class="small-input" min="0" value="0">
                        </div>
                    </div>
                </div>
                <div class="blueprint-dock">
                    <div class="nav-pill">
                        <span>Drag rooms to reposition. Click to edit details. Blueprint uses a clean grid (1
                            square = 2 meters).</span>
                    </div>
                    <div id="hq-grid" class="hq-grid" role="presentation"></div>
                </div>
            </section>

            <aside class="control-panel">
                <section class="card detail" id="detail-panel">
                    <div class="detail-empty">
                        <p>Select a room to tune its dimensions, downtime activities, and deployment caches.</p>
                    </div>
                    <div class="detail-body hidden">
                        <div class="field">
                            <label for="room-name">Room Name</label>
                            <input id="room-name" type="text" placeholder="Operations Bullpen">
                        </div>
                        <div class="field">
                            <label for="room-type">Designation</label>
                            <select id="room-type"></select>
                        </div>
                        <div class="field two-col">
                            <div>
                                <label for="room-width">Width (cells)</label>
                                <input id="room-width" type="number" min="1" max="24">
                            </div>
                            <div>
                                <label for="room-height">Height (cells)</label>
                                <input id="room-height" type="number" min="1" max="24">
                            </div>
                        </div>
                        <div class="field">
                            <label for="room-notes">Notes / Perks</label>
                            <textarea id="room-notes" rows="3"
                                placeholder="Radiant barrier, rapid scry uplink, etc."></textarea>
                        </div>

                        <div class="subsection">
                            <div class="sub-header">
                                <h4>Downtime Activities</h4>
                                <button id="btn-add-downtime" class="btn ghost small">Add Slot</button>
                            </div>
                            <p class="mini">Slots represent where operatives clock downtime actions for extra speed.</p>
                            <div id="downtime-list" class="slot-list"></div>
                        </div>

                        <div class="subsection">
                            <div class="sub-header">
                                <h4>Resource Bays</h4>
                                <button id="btn-add-resource" class="btn ghost small">Add Bay</button>
                            </div>
                            <p class="mini">Resources deployed from a bay launch one segment faster.</p>
                            <div id="resource-list" class="slot-list"></div>
                        </div>

                        <div class="detail-actions">
                            <button id="btn-duplicate" class="btn ghost">Duplicate</button>
                            <button id="btn-delete" class="btn danger">Delete</button>
                        </div>
                    </div>
                </section>

                <section class="card lore">
                    <div class="card-title">Blueprint Doctrine</div>
                    <p class="card-desc">Keep command bays near secure corridors, leave response lanes clear for rapid
                        deployment, and reserve one sealed lab for emergency technical work.</p>
                </section>
            </aside>
        </main>
    </div>

    <script src="js/delegated-handler.js"></script>
    <script src="js/sw-register.js"></script>
    <script src="js/store.js"></script>
    <script src="js/hq.js"></script>
    <script src="js/vector-field.js"></script>
</body>

</html>
